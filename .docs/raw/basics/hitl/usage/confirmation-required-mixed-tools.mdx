---
title: Confirmation Required with Mixed Tools
sidebarTitle: Mixed Tools Confirmation
keywords: [confirmation, mixed tools, selective confirmation, partial execution]
description: This example demonstrates human-in-the-loop functionality where only some tools require user confirmation. The agent executes tools that don't require confirmation automatically and pauses only for tools that need approval.
mode: wide
---

<Steps>

  <Step title="Create a Python file">
    Create a Python file and add the above code.
    ```bash
    touch confirmation_required_mixed_tools.py
    ```
  </Step>


  <Step title="Add the following code to your Python file">
    ```python confirmation_required_mixed_tools.py
    import asyncio
    import json

    import httpx
    from agno.agent import Agent
    from agno.db.sqlite import SqliteDb
    from agno.models.openai import OpenAIChat
    from agno.tools import tool
    from agno.utils import pprint
    from rich.console import Console
    from rich.prompt import Prompt

    console = Console()


    @tool(requires_confirmation=True)
    def get_top_hackernews_stories(num_stories: int) -> str:
        """Fetch top stories from Hacker News.

        Args:
            num_stories (int): Number of stories to retrieve

        Returns:
            str: JSON string containing story details
        """
        # Fetch top story IDs
        response = httpx.get("https://hacker-news.firebaseio.com/v0/topstories.json")
        story_ids = response.json()

        # Yield story details
        all_stories = []
        for story_id in story_ids[:num_stories]:
            story_response = httpx.get(
                f"https://hacker-news.firebaseio.com/v0/item/{story_id}.json"
            )
            story = story_response.json()
            if "text" in story:
                story.pop("text", None)
            all_stories.append(story)
        return json.dumps(all_stories)


    agent = Agent(
        model=OpenAIChat(id="gpt-4o-mini"),
        tools=[get_top_hackernews_stories],
        markdown=True,
        db=SqliteDb(db_file="tmp/confirmation_required_mixed_tools.db"),
    )

    run_response = asyncio.run(agent.arun("Fetch the top 2 hackernews stories"))
    if run_response.is_paused:
        for requirement in run_response.active_requirements:
            if requirement.needs_confirmation:
                # Ask for confirmation
                console.print(
                    f"Tool name [bold blue]{requirement.tool_execution.tool_name}({requirement.tool_execution.tool_args})[/] requires confirmation."
                )
                message = (
                    Prompt.ask("Do you want to continue?", choices=["y", "n"], default="y")
                    .strip()
                    .lower()
                )

                if message == "n":
                    requirement.reject()
                else:
                    requirement.confirm()


    run_response = asyncio.run(agent.acontinue_run(run_response=run_response))
    # Or
    # run_response = asyncio.run(agent.acontinue_run(run_id=run_response.run_id))

    pprint.pprint_run_response(run_response)


    # Or for simple debug flow
    # asyncio.run(agent.aprint_response("Fetch the top 2 hackernews stories"))

    ```
  </Step>

  <Snippet file="create-venv-step.mdx" />

  <Step title="Install libraries">
    ```bash
    pip install -U agno openai httpx rich
    ```
  </Step>

  <Step title="Export your OpenAI API key">

    <CodeGroup>

    ```bash Mac/Linux
      export OPENAI_API_KEY="your_openai_api_key_here"
    ```

    ```bash Windows
      $Env:OPENAI_API_KEY="your_openai_api_key_here"
    ```
    </CodeGroup>
  </Step>

  <Step title="Run Agent">
    <CodeGroup>
    ```bash Mac
    python confirmation_required_mixed_tools.py
    ```

    ```bash Windows
    python confirmation_required_mixed_tools.py
    ```
    </CodeGroup>
  </Step>

  <Step title="Find All Cookbooks">
  Explore all the available cookbooks in the Agno repository. Click the link below to view the code on GitHub:

  <Link href="https://github.com/agno-agi/agno/tree/main/cookbook/03_agents/human_in_the_loop" target="_blank">
    Agno Cookbooks on GitHub
  </Link>
</Step>
</Steps>
